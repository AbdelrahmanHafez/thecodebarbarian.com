<html><head><script type="text/javascript">var _sf_startpt=(new Date()).getTime()
</script><title>Why I (Almost) Never Use npm's -g Flag | www.thecodebarbarian.com</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,600,700" rel="stylesheet" type="text/css"/><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/><link href="/style/style.css" rel="stylesheet" type="text/css"/><link href="/style/github.css" rel="stylesheet" type="text/css"/><script href="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script><script href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script><script href="/javascript/sidebar.js" type="text/javascript"></script><meta property="og:title" content="Why I (Almost) Never Use npm's -g Flag"/><meta property="og:url" content="http://www.thecodebarbarian.com/2015/02/27/npm-install--g"/><meta property="og:image" content="//i.imgur.com/Qi3TwnH.png"/><meta property="og:site_name" content="The Code Barbarian"/></head><body><div class="navbar social-links hidden-sm hidden-xs"><div class="container"><ul class="nav navbar-nav navbar-right"><li><a href="http://www.twitter.com/code_barbarian">twitter</a></li><li><a href="http://www.github.com/vkarpov15">github</a></li></ul></div></div><div id="nav" class="navbar"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#home-nav-mobile" class="btn btn-default navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand big-brand"><img src="/images/Barbarian_Head.png" class="logo"/><span class="site-name">The Code Barbarian  </span></a></div><div id="home-nav-mobile" class="navbar-right collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/tag/mongodb">MongoDB</a></li><li><a href="/tag/angularjs">AngularJS</a></li><li><a href="/tag/nodejs">NodeJS</a></li><li><a href="/tag/paleo">Paleo</a></li><li class="hidden-md hidden-lg"><a href="#">@code_barbarian</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Github</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Facebook</a></li></ul></div></div></div><div class="container-fluid"><div id="desktop-right-bar" class="col-lg-3 col-lg-offset-9 right-bar"><div class="right-bar-content-slider pull-right"><div class="row search-container"><div class="col-lg-12"><div class="form-group"></div><label>Search</label><form onsubmit="window.location.href = 'https://www.google.im/search?q=' + encodeURIComponent(document.getElementById('searchQ').value) + '+site:thecodebarbarian.com'; return false;"><div class="input-group"><input id="searchQ" type="text" class="form-control"/><div class="input-group-addon search-button"><i class="fa fa-search"></i></div></div></form></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12"><p class="right-bar-label">All Time Most Popular </p><ul class="list-unstyled"><li class="right-bar-li"><a href="/2013/07/22/introduction-to-the-mean-stack-part-one-setting-up-your-tools/">Introduction to the MEAN Stack, Part One: Setting Up Your Tools</a></li><li class="right-bar-li"><a href="/2013/09/23/the-8020-guide-to-writing-angularjs-directives/">The 80/20 Guide to Writing AngularJS Directives</a></li><li class="right-bar-li"><a href="/2013/07/29/introduction-to-the-mean-stack-part-two-building-and-testing-a-to-do-list/">Introduction to the MEAN Stack, Part Two: Building and Testing a To-do List</a></li><li class="right-bar-li"><a href="/2013/05/12/how-to-easily-validate-any-form-ever-using-angularjs/">How to Easily Validate Any Form Ever Using AngularJS</a></li></ul></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12"><p class="right-bar-label">Recent Posts</p><ul class="list-unstyled"><li class="right-bar-li"><a href="/2015/04/24/80-20-guide-to-ecmascript-6-proxies">An 80/20 Guide to ECMAScript 6 Proxies</a></li><li class="right-bar-li"><a href="/2015/04/10/shippable-an-alternative-take-on-travis">Shippable: An Alternative Take on Travis</a></li><li class="right-bar-li"><a href="/2015/03/20/callback-hell-is-a-myth">Callback Hell is a Myth</a></li><li class="right-bar-li"><a href="/2015/03/13/testing-rest-apis-with-acquit">Testing and Documenting Node.js APIs with Mocha and Acquit</a></li></ul></div></div></div></div></div><div id="mobile-sharing-options" class="container-fluid hidden-sm hidden-md hidden-lg"><div class="row"><div class="col-lg-12"><div class="post-sharing-options"><div class="row"><div class="col-xs-3 twitter-share sharing-option"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F2015%2F02%2F27%2Fnpm-install--g&amp;via=code_barbarian" class="social"><i class="fa fa-twitter"></i></a></div><div class="col-xs-3 facebook-share sharing-option"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F02%2F27%2Fnpm-install--g" class="social"><i class="fa fa-facebook"></i></a></div><div class="col-xs-3 google-share sharing-option"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F02%2F27%2Fnpm-install--g" class="social"><i class="fa fa-google-plus"></i></a></div><div class="col-xs-3 comment sharing-option"><a href="#disqus_thread" class="social"><i class="fa fa-comment"></i></a></div></div></div></div></div></div><div id="desktop-sharing-options" class="post-sharing-options hidden-xs pull-left"><ul class="list-unstyled"><li class="twitter-share"><a href="https://twitter.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F2015%2F02%2F27%2Fnpm-install--g&amp;via=code_barbarian" class="social"><i class="fa fa-twitter sharing-option"></i></a></li><li class="facebook-share"><a href="https://www.facebook.com/sharer/sharer.php?u=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F02%2F27%2Fnpm-install--g" class="social"><i class="fa fa-facebook sharing-option"></i></a></li><li class="google-share"><a href="https://plus.google.com/share?url=http%3A%2F%2Fwww.thecodebarbarian.com%2F%2F2015%2F02%2F27%2Fnpm-install--g" class="social"><i class="fa fa-google-plus sharing-option"></i></a></li></ul></div><div class="container"><div class="col-lg-9 post-text"><div class="row"><div class="title-byline-container"><h1 class="post-title">Why I (Almost) Never Use npm's -g Flag </h1><div class="credits"><span class="byline">by Valeri Karpov</span><span class="byhandle"><a href="http://www.twitter.com/code_barbarian">@code_barbarian</a></span><span class="bydate">February 27, 2015</span></div></div></div><div class="post-body-text-container"><p>Every so often I run into an <a href="https://www.npmjs.com/package/marked">npm module that uses <code>preferGlobal: true</code></a>
or asks me to <code>npm install gulp -g</code> to run tests.
My training as a developer has made it so the term &#39;global&#39; makes me gag. 
The <code>-g</code> flag is antithetical to what got me excited about node in the 
first place, which is why I don&#39;t even <a href="http://thecodebarbarian.com/2015/01/17/angularjs-loopback">install modules like StrongLoop</a>
with <code>-g</code>. Here&#39;s why.</p>
<h1 id="one-step-installs">One-Step Installs</h1>
<p>The number one reason why I got into node in the first place
was that setting up a dev environment was easy enough that a
designer or product manager could do it.
In other web server setups I&#39;ve worked with, like Rails or Apache, getting 
a designer set up to run the server locally was a sisyphean ordeal.
I&#39;m sure using numerous global modules was a reasonable idea when only
full-fledged engineers touched code and engineers worked on one codebase 
on one machine, but that time is long past.</p>
<p>Seeing how Node worked was a dream come true. All I had to do
was set up Node, clone a git repo, and run <code>npm install</code>.
No need to install Java, finagle your <code>PATH</code>, or copy a config file into some
obscure OS-dependent <code>/var/blah</code> directory. All of a sudden, I had
a huge weight off my shoulders when the product guys could
modify the home page copy without going through me.</p>
<p>The <code>-g</code> flag breaks this idyllic setup. Saying &quot;run <code>npm install gulp -g</code> after <code>npm install</code>&quot; doesn&#39;t seem like much,
but it sneaks in a great deal of operational complexity.
The first question is, &quot;what version of gulp?&quot; Suppose tomorrow
gulp releases a new version that breaks your code. Now everybody
who installs gulp will be unable to run tests. That&#39;s ok, you
can fix it. But then you have to get everyone to upgrade gulp - time to
send out an email that everybody&#39;s going to ignore
anyway. Or you could tell everyone to run <code>npm install</code> and
<code>npm upgrade -g</code> every time they pull, which will ensure that
nobody on your team can use gulp until you push a fix. And
what if somebody needs to check out an old commit that will
only work with an older version of gulp?</p>
<p><img src="//i.imgur.com/PfWLSfz.png" /></p>
<p>If only you had a way to map which commit depended on which
version of gulp... Oh wait, that&#39;s called <code>package.json</code>. Is it worth it to type <code>gulp</code> instead of <code>./node_modules/gulp/bin/gulp.js</code>, especially when you can just
create a shortcut in your <code>package.json</code> <code>scripts</code> section or in a <code>Makefile</code>?
I love some good syntactic sugar as much as the next developer,
but I don&#39;t think its worth the hassle.</p>
<h1 id="when-g-is-useful">When <code>-g</code> is Useful</h1>
<p>I&#39;d argue the only case where <code>-g</code> is useful would be modules
like <a href="https://www.npmjs.com/package/n">n</a>, <a href="https://www.npmjs.com/package/nvm">nvm</a>, and <a href="https://www.npmjs.com/package/npm">npm</a>.
When your primary purpose is to manage the bare minimum global
dependencies necessary to run <code>npm install</code> rather than interact
directly with application code, I can see the merit.</p>
<p>Why am I ok with <code>node</code> and <code>npm</code> as dependencies that you need
to install globally? Because, at bare minimum, you need to be able
to parse the <code>package.json</code> file and install other dependencies.
To automatically install the other dependencies, you need some software,
so you might as well install globally. Since npm is an evolving codebase,
<a href="https://github.com/promises-aplus/promises-tests/pull/69">relying on globally installed npm versions has its difficulties</a>,
but thankfully <a href="https://docs.npmjs.com/files/package.json#enginestrict">npm has a mechanism for dealing with that</a>.</p>
<h1 id="conclusion">Conclusion</h1>
<p>My mentor in undergrad, <a href="http://en.wikiquote.org/wiki/Brian_Kernighan">Brian Kernighan</a>, once wrote that
&quot;everyone knows that debugging is twice as hard as writing a program in the first place. So if you&#39;re as clever as you can be when you write it, how will you ever debug it?&quot; I&#39;d argue
that getting a non-technical product or marketing person to be comfortable
making small text changes without blowing up your code is twice as hard
as debugging it. If you value getting the less technical members of your
team involved, I&#39;d recommend not going overboard on syntactic sugar and
make it as brain-dead simple as possible to get started with your software.</p>
</div><div style="color: #666666; border-top: 1px dashed #666666; margin: 25px; text-align: center; padding-top: 10px"><em>Found a typo or error? Open up a pull request! This post is
available as markdown on&nbsp;<a href="https://github.com/vkarpov15/thecodebarbarian.com/blob/master/lib/posts/20150227_npm_install_g.md">Github</a></em></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'codebarbarian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><div style="padding-bottom: 100px">&nbsp;</div><script type="text/javascript">!function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.0.1";
  analytics.load("5DErrxzVhprg8sNh8xaiKDR6dNa7yGTI");
  analytics.page()
}}();</script><script type="text/javascript">analytics.track('opened post',
  { title: "Why I (Almost) Never Use npm's -g Flag", time: new Date() });
  </script></body></html>