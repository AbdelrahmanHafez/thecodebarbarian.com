<html><head><script type="text/javascript">var _sf_startpt=(new Date()).getTime()
</script><title>The Future of MongooseJS | www.thecodebarbarian.com</title><meta name="viewport" content="width=device-width, initial-scale=1"/><link href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:200,300,400,600" rel="stylesheet" type="text/css"/><link href="//fonts.googleapis.com/css?family=Merriweather:400,400italic,600,700" rel="stylesheet" type="text/css"/><link href="//maxcdn.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css" rel="stylesheet"/><link href="/style/style.css" rel="stylesheet" type="text/css"/><script href="http://code.jquery.com/jquery-2.1.1.min.js" type="text/javascript"></script><script href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js" type="text/javascript"></script><meta property="og:title" content="The Future of MongooseJS"/><meta property="og:url" content="http://www.thecodebarbarian.com/2014/06/03the-future-of-mongoosejs"/><meta property="og:image" content="//thecodebarbarian.files.wordpress.com/2014/06/harmony_is_coming.jpg?w=199&amp;h=300"/><meta property="og:site_name" content="The Code Barbarian"/></head><body><div class="navbar social-links hidden-sm hidden-xs"><div class="container"><ul class="nav navbar-nav navbar-right"><li><a href="http://www.twitter.com/code_barbarian">twitter</a></li><li><a href="http://www.github.com/vkarpov15">github</a></li></ul></div></div><div id="nav" class="navbar"><div class="container"><div class="navbar-header"><button type="button" data-toggle="collapse" data-target="#home-nav-mobile" class="btn btn-default navbar-toggle"><span class="sr-only">Toggle navigation</span><span class="icon-bar"></span><span class="icon-bar"></span><span class="icon-bar"></span></button><a href="/" class="navbar-brand big-brand"><img src="/images/Barbarian_Head.png" class="logo"/><span class="site-name">The Code Barbarian  </span></a></div><div id="home-nav-mobile" class="navbar-right collapse navbar-collapse"><ul class="nav navbar-nav"><li><a href="/tag/mongodb">MongoDB</a></li><li><a href="/tag/angularjs">AngularJS</a></li><li><a href="/tag/nodejs">NodeJS</a></li><li><a href="/tag/paleo">Paleo</a></li><li class="hidden-md hidden-lg"><a href="#">@code_barbarian</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Github</a></li><li class="hidden-md hidden-lg"><a href="#">TCB Facebook</a></li></ul></div></div></div><div class="container-fluid"><div class="col-lg-3 col-lg-offset-9 right-bar hidden-md hidden-sm hidden-xs"><div class="right-bar-content-slider pull-right"><div class="row search-container"><div class="col-lg-12"><div class="form-group"></div><label>Search</label><form onsubmit="window.location.href = 'http://blekko.com/ws/?q=' + encodeURIComponent(document.getElementById('searchQ').value) +  ' /vkarpov15/thecodebarbarian'; return false;"><div class="input-group"><input id="searchQ" type="text" class="form-control"/><div class="input-group-addon search-button"><i class="fa fa-search"></i></div></div></form></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12"><p class="right-bar-label">All Time Most Popular </p><ul class="list-unstyled"><li class="right-bar-li"><a href="/2013/07/22/introduction-to-the-mean-stack-part-one-setting-up-your-tools/">Introduction to the MEAN Stack, Part One: Setting Up Your Tools</a></li><li class="right-bar-li"><a href="/2013/09/23/the-8020-guide-to-writing-angularjs-directives/">The 80/20 Guide to Writing AngularJS Directives</a></li><li class="right-bar-li"><a href="/2013/07/29/introduction-to-the-mean-stack-part-two-building-and-testing-a-to-do-list/">Introduction to the MEAN Stack, Part Two: Building and Testing a To-do List</a></li><li class="right-bar-li"><a href="/2013/05/12/how-to-easily-validate-any-form-ever-using-angularjs/">How to Easily Validate Any Form Ever Using AngularJS</a></li></ul></div></div><div class="row recent-posts right-bar-group"><div class="col-lg-12"><p class="right-bar-label">Recent Posts</p><ul class="list-unstyled"><li class="right-bar-li"><a href="/2014/09/04defending-against-query-selector-injection-attacks">Defending Against Query Selector Injection Attacks</a></li><li class="right-bar-li"><a href="/2014/06/03the-future-of-mongoosejs">The Future of MongooseJS</a></li><li class="right-bar-li"><a href="/2014/05/09whats-new-in-mongoose-3-8-9">What's New in Mongoose 3.8.9</a></li><li class="right-bar-li"><a href="/2014/04/25a-nodejs-perspective-on-whats-new-in-mongodb-2-6-part-ii-aggregation-out">A NodeJS Perspective on What's New in MongoDB 2.6, Part II: Aggregation $out</a></li></ul></div></div></div></div></div><div id="mobile-sharing-options" class="container-fluid hidden-sm hidden-md hidden-lg"><div class="row"><div class="col-lg-12"><div class="post-sharing-options"><div class="row"><div class="col-xs-3 twitter-share sharing-option"><i class="fa fa-twitter"></i></div><div class="col-xs-3 facebook-share sharing-option"><i class="fa fa-facebook"></i></div><div class="col-xs-3 google-share sharing-option"><i class="fa fa-google-plus"></i></div><div class="col-xs-3 comment sharing-option"><i class="fa fa-comment"></i></div></div></div></div></div></div><div id="desktop-sharing-options" class="post-sharing-options hidden-xs pull-left"><ul class="list-unstyled"><li class="twitter-share"><i class="fa fa-twitter sharing-option"></i></li><li class="facebook-share"><i class="fa fa-facebook sharing-option"></i></li><li class="google-share"><i class="fa fa-google-plus sharing-option"></i></li></ul></div><div class="container"><div class="col-lg-9 post-text"><div class="row"><div class="title-byline-container"><h1 class="post-title">The Future of MongooseJS </h1><div class="credits"><span class="byline">by Valeri Karpov</span><span class="byhandle"><a href="http://www.twitter.com/code_barbarian">@code_barbarian</a></span><span class="bydate">June 03, 2014</span></div></div></div><div class="post-body-text-container"><p>Two weeks ago marked a big milestone: <a href="https://github.com/LearnBoost/mongoose/blob/master/History.md#390-unstable--2014-05-22">mongoose 3.9.0</a> was released. Be warned, mongoose&#39;s versioning practice is that even numbered branches are stable and odd are unstable. While all our tests check out on 3.9.0, I would recommend sticking to 3.8.x releases in production for now. 3.9.0 was mongoose&#39;s first unstable release since October 2013. While the changes in 3.9.0 were relatively minor, they open the door to getting some interesting features into 4.0. Here are some of the high-level features I think should make it in to 4.0:</p>
<h2 id="1-update-with-validators">1) Update() with Validators</h2>
<p>Mongoose right now doesn&#39;t run validators on calls to <code>Model.update()</code>. I&#39;ve found often that its more elegant and performant to <a href="https://github.com/vkarpov15/lean-mean-nutrition-sample/blob/master/routes/api.js#L42-63">call <code>update()</code> directly</a> instead of loading the document, modifying it, and then saving it. Mongoose should have better support for this paradigm in the future.</p>
<h2 id="2-browser-friendly-and-browserify-friendly-schema-validation-module-">2) Browser-friendly and browserify-friendly schema validation module.</h2>
<p>Currently, there&#39;s no good way to send your schemas to the browser to do client-side validation. While introducing an <a href="http://thecodebarbarian.com/2013/05/12/how-to-easily-validate-any-form-ever-using-angularjs/">API endpoint for validation</a> is quite possible, hooking up mongoose schema validation directly to a tool like AngularJS in the browser can open up some incredibly cool opportunities.</p>
<h2 id="3-better-integration-with-koa-js-http-koajs-com-and-harmony-http-en-wikipedia-org-wiki-ecmascript-ecmascript_harmony_-286th_edition-29-in-general">3) Better integration with <a href="http://koajs.com/">Koa.js</a> and <a href="http://en.wikipedia.org/wiki/ECMAScript#ECMAScript_Harmony_.286th_Edition.29">Harmony</a> in general</h2>
<p>Fair warning, I&#39;m not well versed in the particulars of ES6 or Koa just yet, but I have noticed some people opening Github issues related to these subjects. As more people start moving to ES6, mongoose needs to have its A-game ready.</p>
<p><a href="http://thecodebarbarian.files.wordpress.com/2014/06/harmony_is_coming.jpg?w=199&amp;h=300"><img src="http://thecodebarbarian.files.wordpress.com/2014/06/harmony_is_coming.jpg?w=199&h=300"></a></p>
<h2 id="4-per-document-events-https-github-com-learnboost-mongoose-issues-2090-">4) <a href="https://github.com/LearnBoost/mongoose/issues/2090">Per-document events</a></h2>
<p>The general idea is that mongoose doesn&#39;t scope document events to a particular document, that is, <code>doc1.on(&#39;event&#39;)</code> will get triggered by <code>doc2.emit(&#39;event&#39;)</code> if <code>doc1</code> and <code>doc2</code> are instances of the same model. This is expected behavior now, but its very counterintuitive. At the very least, in 4.0 <code>doc1.on(&#39;event&#39;)</code> will get triggered by <code>doc2.emit(&#39;event&#39;)</code> if doc1 and doc2 are the same JS object. However, we may introduce behavior where <code>doc1.on(&#39;event&#39;)</code> will get triggered by <code>doc2.emit(&#39;event&#39;)</code> if <code>doc1</code> and <code>doc2</code> have the same <code>_id</code>.</p>
<h2 id="5-reworking-population">5) Reworking Population</h2>
<p>Populate is extremely useful, but also has some very unfortunate dark corners and counter-intuitive behavior that I&#39;d like to rework. There are numerous features, such as caching integration, <a href="https://github.com/LearnBoost/mongoose/issues/2075">manual population</a>, and populating on <a href="https://github.com/LearnBoost/mongoose/issues/1888">fields other than _id</a> that the current implementation makes very difficult. I&#39;m hoping to get all these features into 4.0.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I&#39;m still very much in the planning stages for mongoose 4.0, so comments, concerns, and feature suggestions are very much welcome. Feel free to open up <a href="https://github.com/LearnBoost/mongoose/issues">issues on Github</a> with features you&#39;d like to see in 4.0.</p>
</div><div style="color: #666666; border-top: 1px dashed #666666; margin: 25px; text-align: center; padding-top: 10px"><em>Found a typo or error? Open up a pull request! This post is
available as markdown on&nbsp;<a href="https://github.com/vkarpov15/thecodebarbarian.com/blob/master/lib/posts/20140603_mongoose_future.md">Github</a></em></div><div id="disqus_thread"></div><script type="text/javascript">/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'codebarbarian'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript><a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a></div></div><div style="padding-bottom: 100px">&nbsp;</div><script type="text/javascript">var _sf_async_config = { uid: 57424, domain: 'rearden.us.to', useCanonical: true };
(function() {
  function loadChartbeat() {
    window._sf_endpt = (new Date()).getTime();
    var e = document.createElement('script');
    e.setAttribute('language', 'javascript');
    e.setAttribute('type', 'text/javascript');
    e.setAttribute('src','//static.chartbeat.com/js/chartbeat.js');
    document.body.appendChild(e);
  };
  var oldonload = window.onload;
  window.onload = (typeof window.onload != 'function') ?
    loadChartbeat : function() { oldonload(); loadChartbeat(); };
})();</script></body></html>